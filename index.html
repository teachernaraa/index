<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>NFC Redirect</title>
  <script>
    // Apps Script-–∞–∞—Å –±—É—Ü–∞–∞—Ö callback —Ñ—É–Ω–∫—Ü
    function handleResponse(response) {
      if (response.status === "ok" && response.redirect) {
        // –®—É—É–¥ –∑–∞–∞—Å–∞–Ω —Ö—É—É–¥–∞—Å —Ä—É—É —à–∏–ª–∂“Ø“Ø–ª–Ω—ç
        window.location.href = response.redirect;
      } else {
        document.body.innerHTML = "<h3>‚ùå –ê–ª–¥–∞–∞: " + response.message + "</h3>";
      }
    }

    // Token –∞–≤–∞—Ö + Apps Script —Ä—É—É —Ö“Ø—Å—ç–ª—Ç –∏–ª–≥—ç—ç—Ö
    window.onload = function () {
      const params = new URLSearchParams(window.location.search);
      const key = params.get("key");

      if (!key) {
        document.body.innerHTML = "<h3>‚ö†Ô∏è Token –æ—Ä—É—É–ª–∞–∞–≥“Ø–π –±–∞–π–Ω–∞</h3>";
        return;
      }

      // JSONP script –¥–∏–Ω–∞–º–∏–∫–∞–∞—Ä –æ—Ä—É—É–ª–Ω–∞
      const script = document.createElement("script");
      script.src = "https://script.google.com/macros/s/AKfycbyBl0X8xuLyDROSC2HfHsfPRVS4Y-GNfO52GDqKZ2R6a-krt2sLWsDnn3dy6H9RspAMhg/exec"
                  + "?key=" + encodeURIComponent(key)
                  + "&callback=handleResponse";
      document.body.appendChild(script);
    };
  </script>
</head>
<body>
  <h3>üîÑ –£–Ω—à–∏–∂ –±–∞–π–Ω–∞...</h3>
</body>
</html>
