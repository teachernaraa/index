<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>NFC Redirect</title>
  <script>
    // Apps Script-–∞–∞—Å JSONP —Ö–∞—Ä–∏—É–≥ —Ö“Ø–ª—ç—ç–Ω –∞–≤–∞—Ö —Ñ—É–Ω–∫—Ü
    function handleResponse(data) {
      if (data.status === "ok") {
        // –®—É—É–¥ ”©”©—Ä–∏–π–Ω URL —Ä—É—É —à–∏–ª–∂–∏–Ω—ç
        window.location.href = data.redirect;
      } else {
        document.body.innerHTML = "<h3 style='color:red'>" + (data.message || "‚õî –ê–ª–¥–∞–∞") + "</h3>";
      }
    }

    // –•—É—É–¥–∞—Å –±“Ø—Ä—ç–Ω –∞—á–∞–∞–ª–∞—Ö–∞–¥ –∞–∂–∏–ª–ª–∞–Ω–∞
    window.onload = function() {
      const params = new URLSearchParams(window.location.search);
      const token = params.get("key");

      if (token) {
        const script = document.createElement("script");
        // === –¢–∞–Ω—ã Apps Script publish URL ===
        script.src = "https://script.google.com/macros/s/AKfycbyBl0X8xuLyDROSC2HfHsfPRVS4Y-GNfO52GDqKZ2R6a-krt2sLWsDnn3dy6H9RspAMhg/exec"
                   + "?key=" + encodeURIComponent(token)
                   + "&callback=handleResponse";
        // head —Ä“Ø“Ø –Ω—ç–º—ç—Ö –Ω—å –∏–ª“Ø“Ø –Ω–∞–π–¥–≤–∞—Ä—Ç–∞–π
        document.head.appendChild(script);
      } else {
        document.body.innerHTML = "<h3>‚õî Token –æ–ª–¥—Å–æ–Ω–≥“Ø–π</h3>";
      }
    }
  </script>
</head>
<body>
  <h3>üîÑ –®–∞–ª–≥–∞–≥–¥–∞–∂ –±–∞–π–Ω–∞...</h3>
</body>
</html>
