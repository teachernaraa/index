<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>NFC Redirect</title>
  <script>
    // JSONP callback function
    function handleResponse(response) {
      console.log("Server response:", response); // debug

      if (response.status === "ok" && response.redirect) {
        // –®—É—É–¥ redirect
        window.location.href = response.redirect;
      } else {
        document.body.innerHTML = "<h3>‚ùå –ê–ª–¥–∞–∞: " + (response.message || "Unknown error") + "</h3>";
      }
    }

    // Script –¥–∏–Ω–∞–º–∏–∫–∞–∞—Ä –∞—á–∞–∞–ª–∞—Ö
    window.onload = function () {
      const urlParams = new URLSearchParams(window.location.search);
      const key = urlParams.get("key");

      if (!key) {
        document.body.innerHTML = "<h3>‚ö†Ô∏è Token –±–∞–π—Ö–≥“Ø–π –±–∞–π–Ω–∞</h3>";
        return;
      }

      // Apps Script URL
      const script = document.createElement("script");
      script.src = "https://script.google.com/macros/s/AKfycbyBl0X8xuLyDROSC2HfHsfPRVS4Y-GNfO52GDqKZ2R6a-krt2sLWsDnn3dy6H9RspAMhg/exec"
                 + "?key=" + encodeURIComponent(key)
                 + "&callback=handleResponse";
      document.body.appendChild(script);
    };
  </script>
</head>
<body>
  <h3>üîÑ –£–Ω—à–∏–∂ –±–∞–π–Ω–∞...</h3>
</body>
</html>
